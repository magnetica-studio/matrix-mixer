/* eslint-disable */
import e from"events";function t(e,t){var r,n;if(0===t.length)return e;for(r=0,n=t.length;r<n;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return e<0?-2*e:e}function r(e,n,o,a){var u,s=t(t(t(e,o),(u=n,Object.prototype.toString.call(u))),typeof n);if(null===n)return t(s,"null");if(void 0===n)return t(s,"undefined");if("object"==typeof n||"function"==typeof n){if(-1!==a.indexOf(n))return t(s,"[Circular]"+o);a.push(n);var i=function(e,t,n){return Object.keys(t).sort().reduce((function(e,o){return r(e,t[o],o,n)}),e)}(s,n,a);if(!("valueOf"in n)||"function"!=typeof n.valueOf)return i;try{return t(i,String(n.valueOf()))}catch(e){return t(i,"[valueOf exception]"+(e.stack||e.message))}}return t(s,n.toString())}var n,o=function(e){return function(e,t){for(;e.length<t;)e="0"+e;return e}(r(0,e,"",[]).toString(16),8)},a=process.env.NODE_ENV,u=function(e,t,r,n,o,u,s,i){if("production"!==a&&void 0===t)throw new Error("invariant requires an error message argument");if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,o,u,s,i],d=0;(l=new Error(t.replace(/%s/g,(function(){return c[d++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}},s=function(e,t,r,n){var o=r?r.call(n,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var a=Object.keys(e),u=Object.keys(t);if(a.length!==u.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),i=0;i<a.length;i++){var l=a[i];if(!s(l))return!1;var c=e[l],d=t[l];if(!1===(o=r?r.call(n,c,d,l):void 0)||void 0===o&&c!==d)return!1}return!0},i=(function(e,t){const r=Symbol.for("ELEM_NODE"),n=new Map,a=new Map,i=new Map;function l(e,t,r,n){return!1}class c{constructor(e,t,n){u("string"==typeof e||"function"==typeof e,`Unexpected Node type ${typeof e}: ${e}`),u(Array.isArray(n),"A Node must be initialized with a valid children array."),this.$$typeof=r,this._type=e,this._hash=null,this._compare=l,this._generation=0,this._props=Object.assign({},t),this._children=n,"function"==typeof e&&t.hasOwnProperty("compare")&&"function"==typeof t.compare&&(this._compare=t.compare)}isPrimitive(){return"string"==typeof this._type}isComposite(){return"function"==typeof this._type}toString(){return null===this._hash||this._hash,this.isPrimitive()?`[Node ${this._type}]`:this.isComposite()?`[Node @@${this._type.name}]`:`[Node ${this._hash}]`}static isNode(e){return"object"==typeof e&&e.hasOwnProperty("$$typeof")&&e.$$typeof===r}}function d(e){if("number"==typeof e)return d(new c("const",{value:e},[]));if(u(c.isNode(e),`Unexpected ${typeof e} passed to core.render: ${e}`),null!==e._hash)return e.isComposite()&&a.has(e._type)?a.get(e._type).subtree:e;if("function"==typeof e._type){if(a.has(e._type)){const t=a.get(e._type),r=t.node,n=r._hash;if(e._compare(r._props,r._children,e._props,e._children))return e._hash=n,a.set(e._type,Object.assign({},t,{node:e})),t.subtree}const t=d(e._type(e._props,...e._children));return e._hash=t._hash,a.set(e._type,{node:e,subtree:t}),t}for(let t=0;t<e._children.length;++t)e._children[t]=d(e._children[t]);if(e._props.hasOwnProperty("key"))return e._hash=o({type:e._type,key:e._props.key,children:e._children.map((e=>e._hash))}),e;if("root"===e._type){const t=o({type:e._type,props:e._props,children:e._children.map((e=>e._hash))});if(n.has(t)&&!i.has(t)){e._props.rc=Math.ceil((1e-10+Math.random())*Date.now());const t=o({type:e._type,props:e._props,children:e._children.map((e=>e._hash))});return e._hash=t,e}return e._hash=t,e}return e._hash=o({type:e._type,props:e._props,children:e._children.map((e=>e._hash))}),e}function p(e,t){if(u(c.isNode(t),`Unexpected ${typeof t} passed to core.render: ${t}`),u(t.isPrimitive(),`Attempting to mount an unresolved node: ${t}`),"root"===t._type&&i.set(t._hash,t),!n.has(t._hash)){e.createNode(t._hash,t._type),n.set(t._hash,t);for(let r in t._props)if(t._props.hasOwnProperty(r)){const n=t._props[r];(null==n||"number"==typeof n&&isNaN(n)||"number"==typeof n&&!isFinite(n))&&console.warn(`Warning: applying a potentially erroneous property value. ${r}: ${n}`),e.setProperty(t._hash,r,n)}for(let r=0;r<t._children.length;++r)p(e,t._children[r]),e.appendChild(t._hash,t._children[r]._hash)}}function h(e,t,r){if(u(n.has(t._hash),"Attempting to update a property for an unknown node.\n\nIt's likely that you're attempting to change the graph topology faster than the rendering can accommodate."),r.has(t._hash))return;const o=n.get(t._hash);o._generation=0;for(let r in t._props)if(t._props.hasOwnProperty(r)){const n=t._props[r];o._props.hasOwnProperty(r)&&s(o._props[r],n)||((null==n||"number"==typeof n&&isNaN(n)||"number"==typeof n&&!isFinite(n))&&console.warn(`Warning: applying a potentially erroneous property value. ${r}: ${n}`),e.setProperty(o._hash,r,n),o._props[r]=n)}r.set(t._hash,!0);for(let n=0;n<t._children.length;++n)h(e,t._children[n],r)}t.renderWith=function e(t,...r){try{for(const e of n.values())e._generation++;let e=r.map((function(e,t){return d(new c("root",{channel:t},[e]))}));i.clear();for(let r=0;r<e.length;++r)p(t,e[r]);let o=new Map;for(let r=0;r<e.length;++r)h(t,e[r],o);t.commitUpdates();for(const[e,r]of n)r._generation>=4&&(t.deleteNode(e),n.delete(e));t.commitUpdates()}catch(t){let r=new Error(t.message);throw r.name="Elementary Error",Error.hasOwnProperty("captureStackTrace")&&"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(r,e),r;/** @preserve node-do-not-add-exception-line */}},t.TERMINAL_GENERATION=4,t.Node=c,t.nodeMap=n,t.memoMap=a,"test"===process.env.NODE_ENV&&(t.resetInternalMaps=function(){n.clear(),a.clear()})}(n={exports:{}},n.exports),n.exports),l=i;function c(e){u(Array.isArray(e),`Trying to flatten something that's not an array: ${e}`);let t=[];for(let r=0;r<e.length;++r)Array.isArray(e[r])?t=t.concat(c(e[r])):t.push(e[r]);return t}function d(e,...t){if(0===t.length)return new l.Node(e,{},[]);const r=c(t);if(l.Node.isNode(r[0])||"number"==typeof r[0])return u(r.length<=8,"Nodes can only have at most 8 children."),new l.Node(e,{},r);const n=r[0],o=r.slice(1);return u(o.length<=8,"Nodes can only have at most 8 children."),new l.Node(e,n,o)}var p={createNode:d,createNodeFactory:function(e){return function(...t){return d(e,...t)}}};const h={};["sin","cos","tan","tanh","asinh","ln","log","log2","ceil","floor","sqrt","exp","abs","le","leq","ge","geq","pow","add","sub","mul","div","mod","min","max","root","in","sr","const","phasor","rand","counter","latch","sample","table","seq","delay","z","pole","env","biquad","convolve","meter","tapIn","tapOut"].forEach((function(e){h[e]=p.createNodeFactory(e)}));var m=h;const f={...m};var y={ms2samps:function(e){return f.mul(f.sr(),f.div(e,1e3))},tau2pole:function(e){return f.exp(f.div(-1,f.mul(e,f.sr())))},select:p.createNodeFactory((function(e,t,r,n){return f.add(f.mul(t,r),f.mul(f.sub(1,t),n))}))};const _={...m,...y,smooth:p.createNodeFactory(v),zero:p.createNodeFactory(b)};function v(e,t,r){return _.pole(t,_.mul(_.sub(1,t),r))}function b(e,t,r,n){return _.sub(_.mul(t,n),_.mul(r,_.z(n)))}var N={smooth:p.createNodeFactory(v),sm:p.createNodeFactory((function(e,t){return _.smooth(_.tau2pole(.02),t)})),zero:p.createNodeFactory(b),dcblock:p.createNodeFactory((function(e,t){return _.pole(.995,_.zero(1,1,t))})),df11:p.createNodeFactory((function(e,t,r,n,o){return _.pole(n,_.zero(t,r,o))})),lowpass:p.createNodeFactory((function(e,t,r,n){const o=_.div(_.mul(2*Math.PI,t),_.sr()),a=_.cos(o),u=_.div(_.sin(o),_.mul(2,r)),s=_.mul(.5,_.sub(1,a)),i=_.sub(1,a),l=_.mul(.5,_.sub(1,a)),c=_.add(1,u),d=_.mul(-2,a),p=_.sub(1,u),h=_.div(1,c);return _.biquad(_.mul(s,h),_.mul(i,h),_.mul(l,h),_.mul(d,h),_.mul(p,h),n)})),highpass:p.createNodeFactory((function(e,t,r,n){const o=_.div(_.mul(2*Math.PI,t),_.sr()),a=_.cos(o),u=_.div(_.sin(o),_.mul(2,r)),s=_.mul(.5,_.add(1,a)),i=_.mul(-1,_.add(1,a)),l=_.mul(.5,_.add(1,a)),c=_.add(1,u),d=_.mul(-2,a),p=_.sub(1,u),h=_.div(1,c);return _.biquad(_.mul(s,h),_.mul(i,h),_.mul(l,h),_.mul(d,h),_.mul(p,h),n)})),bandpass:p.createNodeFactory((function(e,t,r,n){const o=_.div(_.mul(2*Math.PI,t),_.sr()),a=_.cos(o),u=_.div(_.sin(o),_.mul(2,r)),s=u,i=_.mul(-1,u),l=_.add(1,u),c=_.mul(-2,a),d=_.sub(1,u),p=_.div(1,l);return _.biquad(_.mul(s,p),_.mul(0,p),_.mul(i,p),_.mul(c,p),_.mul(d,p),n)})),allpass:p.createNodeFactory((function(e,t,r,n){const o=_.div(_.mul(2*Math.PI,t),_.sr()),a=_.cos(o),u=_.div(_.sin(o),_.mul(2,r)),s=_.sub(1,u),i=_.mul(-2,a),l=_.add(1,u),c=_.add(1,u),d=_.mul(-2,a),p=_.sub(1,u),h=_.div(1,c);return _.biquad(_.mul(s,h),_.mul(i,h),_.mul(l,h),_.mul(d,h),_.mul(p,h),n)})),notch:p.createNodeFactory((function(e,t,r,n){const o=_.div(_.mul(2*Math.PI,t),_.sr()),a=_.cos(o),u=_.div(_.sin(o),_.mul(2,r)),s=_.mul(-2,a),i=_.add(1,u),l=_.mul(-2,a),c=_.sub(1,u),d=_.div(1,i);return _.biquad(_.mul(1,d),_.mul(s,d),_.mul(1,d),_.mul(l,d),_.mul(c,d),n)})),peak:p.createNodeFactory((function(e,t,r,n,o){const a=_.pow(10,_.div(n,40)),u=_.div(_.mul(2*Math.PI,t),_.sr()),s=_.cos(u),i=_.div(_.sin(u),_.mul(2,r)),l=_.add(1,_.mul(i,a)),c=_.mul(-2,s),d=_.sub(1,_.mul(i,a)),p=_.add(1,_.div(i,a)),h=_.mul(-2,s),m=_.sub(1,_.div(i,a)),f=_.div(1,p);return _.biquad(_.mul(l,f),_.mul(c,f),_.mul(d,f),_.mul(h,f),_.mul(m,f),o)})),lowshelf:p.createNodeFactory((function(e,t,r,n,o){const a=_.pow(10,_.div(n,40)),u=_.div(_.mul(2*Math.PI,t),_.sr()),s=_.cos(u),i=_.div(_.sin(u),_.mul(2,r)),l=_.mul(2,i,_.sqrt(a)),c=_.add(a,1),d=_.sub(a,1),p=_.mul(c,s),h=_.mul(d,s),m=_.mul(a,_.add(l,_.sub(c,h))),f=_.mul(2,a,_.sub(d,p)),y=_.mul(a,_.sub(c,h,l)),v=_.add(c,h,l),b=_.mul(-2,_.add(d,p)),N=_.sub(_.add(c,h),l),g=_.div(1,v);return _.biquad(_.mul(m,g),_.mul(f,g),_.mul(y,g),_.mul(b,g),_.mul(N,g),o)})),highshelf:p.createNodeFactory((function(e,t,r,n,o){const a=_.pow(10,_.div(n,40)),u=_.div(_.mul(2*Math.PI,t),_.sr()),s=_.cos(u),i=_.div(_.sin(u),_.mul(2,r)),l=_.mul(2,i,_.sqrt(a)),c=_.add(a,1),d=_.sub(a,1),p=_.mul(c,s),h=_.mul(d,s),m=_.mul(a,_.add(l,c,h)),f=_.mul(-2,a,_.add(d,p)),y=_.mul(a,_.sub(_.add(c,h),l)),v=_.add(_.sub(c,h),l),b=_.mul(2,_.sub(d,p)),N=_.sub(c,h,l),g=_.div(1,v);return _.biquad(_.mul(m,g),_.mul(f,g),_.mul(y,g),_.mul(b,g),_.mul(N,g),o)})),pink:p.createNodeFactory((function(e,t){return _.biquad(1,-.07568359,0,-.53567505,0,_.biquad(1,-1.81835938,.82094419,-1.94363403,.9438566,t))}))};const g={...m,...N};var w={noise:p.createNodeFactory((function(e){return g.sub(g.mul(2,g.rand()),1)})),pinknoise:p.createNodeFactory((function(e){return g.pink(g.noise())}))};const F={...m,train:p.createNodeFactory(O)};function O(e,t){return F.le(F.phasor(t),.5)}function I(e,t){let r=F.le(t,e),n=F.ge(t,F.sub(1,e)),o=F.div(t,e),a=F.div(F.sub(t,1),e);return F.add(F.mul(r,F.sub(F.mul(2,o),F.mul(o,o),1)),F.mul(n,F.add(F.mul(2,a),F.mul(a,a),1)))}function P(e,t){let r=F.phasor(t),n=F.le(r,.5),o=F.sub(F.mul(2,n),1),a=F.div(t,F.sr()),u=I(a,r),s=I(a,F.mod(F.add(r,.5),1));return F.sub(F.add(o,u),s)}var q={train:p.createNodeFactory(O),cycle:p.createNodeFactory((function(e,t){return l.Node.isNode(t)||"number"==typeof t||console.warn(`el.cycle needs a frequency value! Received: ${t}`),F.sin(F.mul(2*Math.PI,F.phasor(t)))})),saw:p.createNodeFactory((function(e,t){return F.sub(F.mul(2,F.phasor(t)),1)})),square:p.createNodeFactory((function(e,t){return F.sub(F.mul(2,F.train(t)),1)})),triangle:p.createNodeFactory((function(e,t){return F.mul(2,F.sub(.5,F.abs(F.saw(t))))})),blepsaw:p.createNodeFactory((function(e,t){let r=F.phasor(t),n=F.sub(F.mul(2,r),1),o=F.div(t,F.sr());return F.sub(n,I(o,r))})),blepsquare:p.createNodeFactory(P),bleptriangle:p.createNodeFactory((function(e,t){let r=F.div(F.mul(4,t),F.sr());return F.mul(r,F.pole(.999,P(0,t)))}))};const k={...m,...y,...N};var E={adsr:p.createNodeFactory((function(e,t,r,n,o,a){let u=k.mul(t,k.sr()),s=k.le(k.counter(a),u),i=k.select(a,k.select(s,1,n),0),l=k.select(a,k.select(s,t,r),o),c=k.tau2pole(k.div(l,6.91));return k.smooth(c,i)})),hann:p.createNodeFactory((function(e,t){return k.mul(.5,k.sub(1,k.cos(k.mul(2*Math.PI,t))))}))};var M={...p,...m,...y,...N,...w,...q,...E,inputs:function(){throw new Error("Not supported until renderContext is supported...")}};function $(e){try{window.webkit.messageHandlers.nativeHandler.postMessage(JSON.stringify(e))}catch(e){throw new Error("Failed to reach the plugin backend. Are you running with the correct renderer?")}}const z={createNode(...e){$(["createNode",...e])},deleteNode(...e){$(["deleteNode",...e])},appendChild(...e){$(["appendChild",...e])},setProperty(...e){$(["setProperty",...e])},commitUpdates(...e){$(["commitUpdates",...e])}};class S extends e.EventEmitter{constructor(){super(),this.Node=i.Node,this.__loaded=!1,this.__sampleRate=0,this.__blockSize=0,this.__numInputs=0,this.__numOutputs=0,this.__quantizeInterval=-1,window.__recvNativeMessage=e=>{const[t,r]=JSON.parse(e);if("configure"===t)return this.__loaded=!0,this.__sampleRate=r.sampleRate,this.__blockSize=r.blockSize,this.__numInputs=r.numInputChannels,this.__numOutputs=r.numOutputChannels,void(this.__quantizeInterval=r.quantizeInterval);this.emit(t,r)}}render(...e){return i.renderWith(z,...e)}getSampleRate(){return this.__sampleRate}getBlockSize(){return this.__blockSize}getNumInputChannels(){return this.__numInputs}getNumOutputChannels(){return this.__numOutputs}getQuantizationInterval(){return this.__quantizeInterval}}var x=new S;export{x as default,M as lib};
